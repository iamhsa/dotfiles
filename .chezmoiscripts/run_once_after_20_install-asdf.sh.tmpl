#!/bin/bash
if [[ ! -f ${HOME}/.asdf/asdf.sh ]]; then
  git clone https://github.com/asdf-vm/asdf.git ~/.asdf --branch v0.9.0
  . ${HOME}/.asdf/asdf.sh
fi
asdf update
mapfile -t tools < ~/.tool-versions
for t in "${tools[@]}"; do
  pkg="$(echo "${t}" | cut -d ' ' -f1)"
  if [[ "${pkg}" = "aws-ssm-tools" || "${pkg}" = "yawsso" ]]; then
    asdf plugin add ${pkg} https://github.com/amrox/asdf-pyapp.git
  else
    asdf plugin add ${pkg}
  fi
  asdf install ${t} 
done
